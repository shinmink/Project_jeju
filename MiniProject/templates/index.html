<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ìœ íŠœë¸Œ í‚¤ì›Œë“œ ìˆ˜ì§‘ê¸°</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
  <h1>ğŸ” ìœ íŠœë¸Œ ê²€ìƒ‰ í‚¤ì›Œë“œ ìˆ˜ì§‘ê¸°</h1>

  <!-- ê²€ìƒ‰ í¼ -->
  <form method="POST" action="/run">
    <label for="query">ê²€ìƒ‰ í‚¤ì›Œë“œ:</label>
    <input type="text" id="query" name="query" required><br>

    <label for="limit">ìˆ˜ì§‘í•  ê°œìˆ˜:</label>
    <input type="number" id="limit" name="limit" value="20" required><br>

    <label for="sort">ì •ë ¬ ë°©ì‹:</label>
    <select id="sort" name="sort">
      <option value="views">ì¡°íšŒìˆ˜ìˆœ</option>
      <option value="latest">ìµœì‹ ìˆœ</option>
    </select><br>

    <button type="submit">ìˆ˜ì§‘ ì‹œì‘</button>
  </form>

  <!-- ë©”ì‹œì§€ ì¶œë ¥ -->
  {% if message %}
    <p class="result">{{ message }}</p>
  {% endif %}

  <!-- ìˆ˜ì§‘ ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸° -->
  {% if preview %}
  <div class="preview">
    <h3>ğŸ“º ìˆ˜ì§‘ ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸°</h3>
    <ul>
      {% for line in preview %}
        {% if line.strip() %}
          <li>{{ line }}</li>
        {% endif %}
      {% endfor %}
    </ul>

    <!-- ë²„íŠ¼ ê·¸ë£¹ -->
    <div class="button-group">
      <form method="POST" action="/keyword_extractor">
        <button type="submit">ğŸŒ¥ï¸ ì›Œë“œí´ë¼ìš°ë“œ ìƒì„±í•˜ê¸°</button>
      </form>

      <form method="POST" action="/scatter_plot">
        <button type="submit">ğŸ“Š ìŠ¤ìºí„° í”Œë¡¯ ìƒì„±í•˜ê¸°</button>
      </form>
    </div>
  </div>
  {% endif %}

  <!-- âœ… show_modalì´ Trueì¼ ë•Œë§Œ ëª¨ë‹¬ ë Œë”ë§ -->
  {% if show_modal %}
  <div id="imageModal" class="modal">
    <div class="modal-content">
      <span class="close" id="modalCloseBtn">&times;</span>
      {% if image %}
        <img src="{{ image }}" alt="ê²°ê³¼ ì´ë¯¸ì§€" style="max-width: 100%; height: auto;">
      {% endif %}
    </div>
  </div>

  <!-- âœ… ëª¨ë‹¬ ë™ì‘ JS (ì¡°ê±´ë¶€ í¬í•¨) -->
  <script>
    window.onload = () => {
      const modal = document.getElementById("imageModal");
      const closeBtn = document.getElementById("modalCloseBtn");

      if (modal) {
        modal.style.display = "block";
      }

      if (closeBtn) {
        closeBtn.onclick = () => {
          modal.style.display = "none";
        };
      }

      window.onclick = (event) => {
        if (event.target === modal) {
          modal.style.display = "none";
        }
      };
    };
  </script>
  {% endif %}
</body>
</html>